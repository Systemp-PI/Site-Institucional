<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./Estilo/cadastro_empresa.css" />
    <link rel="icon" href="./imgs/engrenagem.png" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet" />
    <title>SysTemp | Cadastro</title>
</head>

<body>
    <header>
        <img src="https://i.ibb.co/yXpfmVK/SYSTEMP.png" alt="systemp_logo" />
        <nav>
            <a href="dashboard.html"><u>Sair</u></a>
            <!-- <a href="#sobre_nos">Sobre nós</a>
            <a href="#logo_email">Contato</a>
            <a href="dashboard.html">Dashboard</a>
            <a href="cadastro_empresa.html"><u>Cadastro empresa</u></a>
            -->
        </nav>
    </header>

    <div id="title">
        <h1>Cadastro de empresa:</h1>
    </div>
    <div class="container_cadastro">

        <form>
            <div id="box_form">

                <label for="nome_usuario">Razão social:</label>
                <input type="text" onkeyup="verificarRazaoSocial()" placeholder="Digite o nome de usuário"
                    id="razao_social" required />
                <span id="erro_razao_social"></span>
                <label for="cnpj">CNPJ: </label>
                <input type="number" onkeyup="verificarCnpj()" placeholder="Digite o CNPJ" id="cnpj"
                    title="Somente números" pattern="[0-9]" maxlength="14" minlength="11" required />
                <span id="erro_cnpj"></span>
                <label for="inscricao_estadual">Inscrição estadual </label>
                <input type="text" onkeyup="verificarIe()" placeholder="Digite a inscrição estadual"
                    id="inscricao_estadual" required />
                <span id="erro_ie"></span>
                <label for="nomecontato1"> Nome do contato 1 </label>
                <input type="text" onkeyup="verificarContato1()" placeholder="Digite o nome do contato"
                    id="nomecontato1" required />
                <span id="erro_contato1"></span>
                <label for="nomecontato2"> Nome do contato 2 </label>
                <input type="text" onkeyup="verificarContato2()" placeholder="Digite o nome do contato"
                    id="nomecontato2" required />
                <span id="erro_contato2"></span>
            </div>

            <div id="box_form2">
                <label for="emailcontato1"> Email do contato 1 </label>
                <input type="email" onkeyup="verificarEmail1()" placeholder="Digite o email do contato"
                    id="emailcontato1" required />
                <span id="erro_email1"></span>
                <label for="emailcontato2"> Email do contato 2 </label>
                <input type="email" onkeyup="verificarEmail2()" placeholder="Digite o email do contato"
                    id="emailcontato2" required />
                <span id="erro_email2"></span>
                <label for="telefonecontato"> Tel do contato 1 </label>
                <input type="number" onkeyup="verificarTel1()" placeholder="Digite o telefone do contato"
                    id="telefonecontato" required />
                <span id="erro_telContato"></span>


                <label for="telefonecontato2"> Tel do contato 2 </label>
                <input type="number" onkeyup="verificarTel2()" placeholder="Digite o telefone do contato"
                    id="telefonecontato2" required />
                <span id="erro_telContato2"></span>



                <label for="input_cep"> Cep </label>
                <input onblur="pesquisacep(this.value);" type="number" onkeyup="verificarCep()"
                    placeholder="Digite o Cep da empresa" id="input_cep" required />
                <span id="erro_cep"></span>


            </div>

            <div id="box_form3">

                <label for="input_cidade"> Cidade </label>
                <input style="background-color: white;"  type="text" onkeyup="verificarCidade()"
                    placeholder="Digite a cidade" id="input_cidade" required />
                <span id="erro_cidade"></span>

                <label for="input_bairro"> Bairro </label>
                <input style="background-color: white;"  type="text"
                    placeholder="Digite o bairro da empresa" id="input_bairro" required />
                <span id="erro_bairro"></span>

                <label for="input_rua"> Rua </label>
                <input style="background-color: white;"  type="text"
                    placeholder="Digite o rua da empresa" id="input_rua" required />
                <span id="erro_rua"></span>

                <label for="input_numero"> Numero rua </label>
                <input type="number" onkeyup="verificarNumero()" placeholder="Digite o numero da empresa"
                    id="input_numero" required />
                <span id="erro_numero"></span>

                <label for="input_complemento"> complemento </label>
                <input type="number" placeholder="Digite o complemento da empresa" id="input_complemento" required />
                <span id="erro_complemento"></span>

                <label for="estado">Selecione seu estado </label>
                <select style="background-color: white;"  id="estado" name="estado">
                    <option disabled>Selecione seu estado</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amapá</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Ceará</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Espírito Santo</option>
                    <option value="GO">Goiás</option>
                    <option value="MA">Maranhão</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Pará</option>
                    <option value="PB">Paraíba</option>
                    <option value="PR">Paraná</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piauí</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rondônia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">São Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                    <option value="EX">Estrangeiro</option>
                </select>

            </div>

    </div>
    <button type="button" onclick="cadastrar_empresa()">Enviar</button>
    </form>



    <div id="span_erro">
        <span id="span_erro_nome_usuario"></span>
        <span id="span_erro_cnpj"></span>
        <span id="span_erro_email"></span>
        <span id="span_erro_senha"></span>
        <span id="span_erro_conf_senha"></span>

        <footer>
            <div id="footer_title">
                <h2 id="title">Fale conosco</h2>
            </div>
            <div class="container_footer">
                <a class="enderecos" href="mailto:support@systemp-help.freshdesk.com"><img class="contatos" id="logo_email"
                        src="https://i.ibb.co/b7n7Hkf/logo-email.png">support@systemp-help.freshdesk.com</a>

                <a class="enderecos" href="tel:+5511999999999"><img class="contatos" id="logo_whatsapp"
                        src="https://i.ibb.co/ZKx7HBs/logo-whatsapp.png">+55 (11) 99999-9999 </a>

                <a class="enderecos" href="https://linkedin.com/systemp"> <img class="contatos" id="logo_linkedin"
                        src="https://i.ibb.co/9q18Cz0/logo-linkedin.png">linkedin.com/systemp</a>
            </div>
            <div id="container_copyright">
                <div class="copyright">
                    <p>&copy; 2022 SYSTEMP. Todos os direitos reservados.</p>
                </div>
            </div>
        </footer>
</body>

</html>

<script src="../public/Script/cadastro_empresa.js"></script>

<script>



function pesquisacep() {
        fetch(`https://viacep.com.br/ws/${input_cep.value}/json/`, {
            method: "GET",
            mode: "cors"
        }).then(function (resposta) {
            console.log(resposta)
            resposta.json().then(function (data) {
                console.log(data)
                input_rua.value = data.logradouro;
                input_bairro.value = data.bairro;
                input_cidade.value = data.localidade;
                estado.value = data.uf

            })
        }).catch(function (erro) {
            console.log(erro)
        })
    }
    var razaoSocial = ''
    var pj = ''
    var ie = ''
    var contato1 = ''
    var contato2 = ''
    var email1 = ''
    var email2 = ''
    var tel1 = ''
    var tel2 = ''
    var cep = ''
    var numero = ''

           
            
         


    //Validação razão social
    function verificarRazaoSocial() {
        razaoSocial = String(razao_social.value).trim();
        if (razaoSocial.length < 5) {
            erro_razao_social.innerHTML = '*Digite no minimo 5 caracteres'
            return false
        } else {
            erro_razao_social.innerHTML = '✓'
        }
    }

    //Validação cnpj
    function verificarCnpj() {
        pj = String(cnpj.value).trim();
        if (pj.length != 14) {
            erro_cnpj.innerHTML = 'Digite 14 números'
            return false
        } else {
            erro_cnpj.innerHTML = '✓'
        }
    }

    //Validação inscrição estadual
    function verificarIe() {
        ie = String(inscricao_estadual.value).trim();
        if (ie.length != 9) {
            erro_ie.innerHTML = 'Digite 9 números'
            return false
        } else {
            erro_ie.innerHTML = '✓'
        }
    }

    //Validação nome contato 1
    function verificarContato1() {
        contato1 = String(nomecontato1.value).trim();
        if (contato1.length < 3) {
            erro_contato1.innerHTML = 'Digite no minimo 3 caracteres'
            return false
        } else {
            erro_contato1.innerHTML = '✓'
        }
    }

    //Validação nome contato 2
    function verificarContato2() {
        contato2 = String(nomecontato2.value).trim();
        if (contato2.length < 3) {
            erro_contato2.innerHTML = 'Digite no minimo 3 caracteres'
            return false
        } else {
            erro_contato2.innerHTML = '✓'
        }
    }

    //Validação email 1
    function verificarEmail1() {
        email1 = String(emailcontato1.value).trim();
        if (email1.indexOf("@") > 3 && (email1.endsWith(".com.br") || email1.endsWith(".com") ||
            email1.endsWith(".ind.br") || email1.endsWith(".ind"))) {
            erro_email1.innerHTML = '✓'
        } else {
            erro_email1.innerHTML = '*Insira "@" e terminação .com, por exemplo'
            return false
        }
    }

    //Validação email 2
    function verificarEmail2() {
        email2 = String(emailcontato2.value).trim();
        if (email2.indexOf("@") > 3 && (email2.endsWith(".com.br") || email2.endsWith(".com") ||
            email2.endsWith(".ind.br") || email2.endsWith(".ind"))) {
            erro_email2.innerHTML = '✓'
        } else {
            erro_email2.innerHTML = '*Insira "@" e terminação .com, por exemplo'
            return false
        }
    }

    //Validação tel Contato 1
    function verificarTel1() {
        tel1 = String(telefonecontato.value).trim();
        if (tel1.length < 10) {
            erro_telContato.innerHTML = 'Digite o DD e o número'
            return false
        } else {
            erro_telContato.innerHTML = '✓'
        }
    }

    //Validação tel Contato 2
    function verificarTel2() {
        tel2 = String(telefonecontato2.value).trim();
        if (tel2.length < 10) {
            erro_telContato2.innerHTML = 'Digite o DD e o número'
            return false
        } else {
            erro_telContato2.innerHTML = '✓'
        }
    }

    //Validação CEP
    function verificarCep() {
        cep = String(input_cep.value);
        if (cep.length != 8) {
            erro_cep.innerHTML = 'Digite um CEP com 8 dígitos (apenas números)'
            return false
        } else {
            erro_cep.innerHTML = '✓'
        }
    }

    //Validação cidade
    function verificarCidade() {
        cidade = String(input_cidade.value).trim();
        if (cidade.length < 3) {
            erro_cidade.innerHTML = 'Digite um nome com mais de 3 caracteres'
            return false
        } else {
            erro_cidade.innerHTML = '✓'
        }
    }

    //Validação número do endereço
    function verificarNumero() {
        numero = String(input_numero.value);
        if (numero == '') {
            erro_numero.innerHTML = 'Digite um endereço'
        } else if (numero.length > 5) {
            erro_numero.innerHTML = 'Digite um endereço válido'
        } else {
            erro_numero.innerHTML = '✓'
        }
    }

    function cadastrar_empresa() {
        fetch("/usuarios/cadastrar_empresa", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                razaoServer: razaoSocial,
                cnpjServer: pj,
                insc_estadualServer: ie,
                nomecont1Server: contato1,
                nomecont2Server: contato2,
                emailcont1Server: email1,
                emailcont2Server: email2,
                telcont1Server: tel1,
                telcont2Server: tel2,
                cepServer: cep,
                estadoServer: estado.value,
                cidadeServer: input_cidade.value,
                bairroServer: input_bairro.value,
                ruaServer: input_rua.value,
                numeroServer: numero,
                complementoServer: input_complemento.value

            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.location = "dashboard.html"

            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);

        });

        return false;
    }
</script>